---


---

<h1 id="二、手工提取特征的图像分类">二、手工提取特征的图像分类</h1>
<h2 id="传统分类系统的特征提取">2.2 传统分类系统的特征提取</h2>
<p>曾经讲到鸢尾花分类的时候，我们给出了分类任务的两个核心步骤：<strong>特征提取</strong>和<strong>特征分类</strong><br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4.jpg?x-oss-process=style/watermark" alt="enter image description here"><br>
上图我们为了减少麻烦，所以我也直接给出了手工提取特征的图像分类的过程，从图中可以看出在图像分类过程中，我们主要停滞在了特征提取的步骤，我们该如何提取图像的特征，提取什么特征呢？如果要解决上述问题，我们首先需要把自己看成计算机去看图像。</p>
<h2 id="计算机眼中的图像">2.3 计算机眼中的图像</h2>
<p>图像在计算机中的表示如下图所示。<br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9C%BC%E4%B8%AD%E7%9A%84%E5%9B%BE%E5%83%8F.png?x-oss-process=style/watermark" alt="enter image description here"><br>
<strong>一幅图像在计算机眼中就是一个由数字组成的矩形阵列，即矩阵</strong>，也正是如此图像才可以存储在计算机中。对于矩阵内的<strong>每一个元素，我们称之为像素</strong>；而矩阵的<strong>行数和列数，我们称为分辨率</strong>。我们经常说的1280×720分辨率，值得就是这张图由1280行、720列的像素组成的。反之，如果我们给出一个数字组成的矩阵，然后将矩阵中的每个元素转换为对应的颜色后，并在电脑屏幕上显示出来，既可以复原出这张图像。</p>
<p>细心的同学会发现矩阵中的每个<strong>元素都是介于0-255之间的整数</strong>。对于上图所示的黑白图像，由于只有明暗的区别，因此只需要一个数字就可以表示不同的灰度，通常我们使用0表示最暗的黑色，255表示最亮的白色，所以矩阵的每一个元素都是介于0-255之间的整数。<br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/RGB3%E9%98%B6%E5%BC%A0%E9%87%8F%E8%A1%A8%E7%A4%BA.jpg?x-oss-process=style/watermark" alt="enter image description here"><br>
彩色图像由于使用（R，G，B）三个数字表示一个颜色，他表示用红（R），绿（G），蓝（B）三种基本颜色叠加的颜色，并且三种颜色也都是介于0-255之间的整数。由于使用三种基本颜色叠加成颜色的明亮程度，如（255，0，0）表示纯红色、（136，200，255）表示天蓝色，所以一般一张彩色图像，需要使用一个由整数的立方体阵列来表示，这样的立方体阵列我们称之为三阶张量。这个三阶张量的长度与宽度即为图像的分辨率，高度为3。对于黑白图像，他其实是高度为1的三阶张量。<br>
彩色图像：size(1280,720,3)<br>
黑白图像：size(1280,720,1)</p>
<h2 id="什么是图像特征？">2.4 什么是图像特征？</h2>
<p>如今我们已经了解了计算机眼中的图像，但是仅仅了解了图像并没有用。如果现在在你眼前有猫、小鸟和树叶，我们可以想想，我们人类是如何对图片分类的。</p>
<h2 id="卷积运算">2.5 卷积运算</h2>
<p>卷积运算目前在图像处理中有着广泛的应用，他如我们熟知的加减乘除一样也是一种数学运算。只是参加卷积运算的是向量、矩阵或三阶张量。</p>
<p><strong>1. 向量的卷积运算</strong></p>
<p><strong>向量内积</strong>：<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>v</mi><mn>1</mn></msub><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><msub><mi>v</mi><mn>2</mn></msub><mo>⃗</mo></mover><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mn>5</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>3</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>1</mn><mo>∗</mo><mn>5</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mn>4</mn><mo>+</mo><mn>3</mn><mo>∗</mo><mn>3</mn><mo>=</mo><mn>22</mn></mrow><annotation encoding="application/x-tex">\vec{v_1} \cdot \vec{v_2}=(1,2,3)\cdot(5,4,3)^T=1*5+2*4+3*3=22</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.864em; vertical-align: -0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.2355em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"><svg width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864em; vertical-align: -0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.2355em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"><svg width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">3</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">22</span></span></span></span></span><br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/%E5%90%91%E9%87%8F%E7%9A%84%E5%8D%B7%E7%A7%AF%E8%BF%90%E7%AE%97.jpg?x-oss-process=style/watermark" alt="enter image description here"><br>
<strong>向量的卷积</strong>：仍然是一个向量。他的计算过程如上图所示：</p>
<ul>
<li>我们首先将两个向量的第一个元素对齐，并截去长向量中多于的元素，然后计算这两个维数相同的向量的内积，并将算得的结果作为结果向量的第一个元素。</li>
<li>我们将短向量向下滑动一个元素，从长向量中截去不能与之对应的元素，并计算内积作为结果向量的第二个元素。</li>
<li>重复“滑动-截取-计算内积”这个过程，直到短向量的最后一个元素与长向量的最后一个元素对齐为止。<br>
卷积结果的维数通常比长向量低，因此有时候我们为了使得卷积后的结果向量与原始长向量的长度一直，会在长向量的两端补上一些0.对于如上图所示的长向量(5,4,3,2,1)，我们可以将其两端补零变成(0,5,4,3,2,1,0)，之后再进行卷积运算，得到结果向量为(0,22,16,10,0)。<br>
<strong>2. 矩阵的卷积运算<br>
矩阵的内积：</strong><br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/%E7%9F%A9%E9%98%B5%E7%9A%84%E5%86%85%E7%A7%AF.jpg?x-oss-process=style/watermark" alt="enter image description here"><br>
<strong>矩阵的卷积：</strong><br>
进行向量的卷积时，我们只需要朝着一个方向移动；进行矩阵卷积时，我们通常需要沿着横向和纵向两个方向滑动<br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/%E7%9F%A9%E9%98%B5%E7%9A%84%E5%8D%B7%E7%A7%AF%E8%BF%90%E7%AE%97%E5%8A%A8%E6%80%81.gif" alt="enter image description here"><br>
<strong>3. 三阶张量的卷积</strong><br>
进行三阶张量的卷积时，当两个张量的通道数相同时（下图的图像和卷积核都为两通道），滑动操作和矩阵卷积一样，只需要在长和宽两个方向进行，卷积的结果是一个通道数为1的三阶张量。<br>
<img src="https://imgmd.oss-cn-shanghai.aliyuncs.com/ml/%E4%B8%89%E9%98%B6%E5%BC%A0%E9%87%8F%E7%9A%84%E5%8D%B7%E7%A7%AF.jpg?x-oss-process=style/watermark" alt="enter image description here"></li>
</ul>

